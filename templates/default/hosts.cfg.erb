# Generated by Chef
# host definitions

<% @nodes.each do |n| -%>
define host {
  use server
  address <%= n['ipaddress'] %>
  host_name <%= n['hostname'] %>
<% if n.roles.nil? || n.roles.length == 0 -%>
  hostgroups all
<% else -%>
  hostgroups <%= n.roles.to_a.join(",") %>
<% end -%>
<% if n.has_key? 'icinga' %>
  <% if n['icinga'].has_key? 'additional_contacts' %>
  contacts <%= n['icinga']['additional_contacts'].join(",") %>
  <% end %>
  <% if n['icinga'].has_key? 'additional_contact_groups' %>
  contactgroups <%= n['icinga']['additional_contact_groups'].join(",") %>
  <% end %>
<% end %>
}

<% end -%>
